### 📌 5. 네트워크 기초

#### 📍 브라우저에 URL을 입력하면 무슨 일이 발생할까?

1️⃣ `URL을 해석`한다

`scheme` : 프로토콜이 들어가는 영역

```
scheme://<user>:<password>@<host>:<port>/<url-path>
```

2️⃣ `DNS`를 조회

- Domain Name System
- DNS는 도메인과 IP 주소를 `서로 변환` 해준다
- DNS로 요청을 보내기 전에 `브라우저 캐시와 hosts 파일을 참조`한다.
- DNS는 보통 통신사(ISP)에서 제공하는 것을 사용한다.
- DNS를 운영하는 서버를 보통 `Name Server`라고 부른다.

브라우저는 DNS로 요청을 보내기전에 `몇가지 체크`를 한다.
해당 도메인을 `이미 알고있는지` 확인. 없다면 로컬 컴퓨터의 hosts 파일을 참조
만약 정의가 되어있다면 `내부적으로 IP 반환`하고
둘다 해당이 안된다면 DNS를 호출하고
`Root, TLD, Authoritative Server` 순으로 탐색한다.

```
      URL 해석
        |
      브라우저 캐시 확인
(있다면)/        | (없다면)
  IP 반환    hosts 파일 참조
            /     |
      IP 반환      DNS 호출
                    |
                  Root Server
                    |
                  TLD Server
                    |
                  Authoritative Server
                    |
                  IP 반환
```

3️⃣ `해당 IP가 존재하는 서버`로 이동

- `네트워크 장비 라우터`를 통해 이동한다.
- `동적 라우팅`을 통해 이동한다.

4️⃣ `ARP`를 이용하여 `MAC 주소`를 변환

- Address Resolution Protocol
- `논리 주소인 IP 주소`를 `물리 주소인 MAC 주소`로 변환하는 프로토콜
- 실제 통신을 위해 변하지 않는 고유한 MAC 주소가 필요하다.
- `네트워크 내에 ARP를 Broadcasting`하면 해당 IP 주소를 가지고 있는 기기가 MAC 주소를 반환

4️⃣ - 1️⃣ IP 주소와 MAC 주소

- IP는 `논리적` 인 주소
- MAC은 `물리적`인 주소
- 기계의 실제 위치를 알기 위해선 MAC 주소가 필요하다.
- 왜 논리적 주소와 물리적 주소로 나눈걸까?
  ㄴ `사용용도`가 다르기 때문이다. 
    논리적인 주소는 `서울 종로구 사직로 161` 이런식이고
    물리적인 주소는 실제 GPS 좌표 물리적 주소인 `북위 37도34'.....` 인것이다.

4️⃣ - 2️⃣ 만약 예시로 든 주소에 택배를 보내려면 어떻게 될까?

- 먼저 `논리적 주소를 보고 접근`할것이다. 서울 > 종로구 > 세종로 를 탐색
  탐색 순서가 서울의 진짜 위치, 종로구의 진짜위치, 세종로의 진짜위치를 찾게 된다.
  ARP를 이용했던것과 비슷하다
- `IP는 대역을 통해 범위`를 좁혀나간다.
- 또한, 택배를 보낼 때 중간 거점을 거쳐가며 택배를 보낼 수 있는데 이 `중간 거점들을 라우터`에 비유할 수 있을 것이다.

5️⃣ `TCP 통신` 을 통해 `Socket`을 열어야 한다.

- 네트워크를 통해 해당 기기로 `패킷을 전달`한다.
- `3 way handshake`로 연결을 요청한다.
- 요청이 수락되면 기기는 패킷을 받아 처리한다.

물건을 전달하기 위해 초인종을 눌러 허락을 받는것이라 생각.
거절당하면 전달이 불가하다. 수락한다면 데이터를 서버로 전달하게 된다.

6️⃣ 서버는 `응답`을 반환

- HTTP 프로토콜로 들어온 `패킷을 읽고 처리`한다.
- `요청에 따른 적절한 응답 값을 반환`한다.

7️⃣ 브라우저는 `렌더링`

- HTML을 읽어 `DOM Tree`를 구축한다.
- 만들어진 DOM Tree를 이용하여 `화면에 그린다.`
- 스크립트를 실행한다.

> 실제로 더 알아야할 것
- OSI 7 계층 : 네트워크 통수신을 위함
- Routing Table : 통신을 위함
- Subnet mask : IP를 효과적으로 사용함.
- TCP Socket Stream